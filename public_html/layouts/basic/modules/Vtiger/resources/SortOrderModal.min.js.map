{"version":3,"file":"SortOrderModal.min.js","sources":["SortOrderModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n\"use strict\";\n\n$.Class(\n\t\"Base_SortOrderModal_JS\",\n\t{},\n\t{\n\t\t/**\n\t\t * Modal container\n\t\t */\n\t\tcontainer: false,\n\t\t/**\n\t\t * Source container\n\t\t */\n\t\tsourceContainer: false,\n\t\t/**\n\t\t * Modal ID\n\t\t */\n\t\tsource: false,\n\t\t/**\n\t\t * Load data\n\t\t */\n\t\tloadData: function() {\n\t\t\tlet orderBy = this.sourceContainer.find(\"#orderBy\").val();\n\t\t\torderBy = orderBy ? JSON.parse(orderBy) : [];\n\t\t\tif (orderBy && Object.keys(orderBy).length) {\n\t\t\t\tlet baseOrderBy = this.container.find(\".js-base-element\");\n\t\t\t\tfor (let field in orderBy) {\n\t\t\t\t\tif (!baseOrderBy.find(\"option[value='\" + field + \"']\").length) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tlet element = this.addRow();\n\t\t\t\t\telement\n\t\t\t\t\t\t.find(\"select.js-orderBy\")\n\t\t\t\t\t\t.val(field)\n\t\t\t\t\t\t.change();\n\t\t\t\t\tlet sortIcon = element.find(\".js-sort-icon-active\");\n\t\t\t\t\tif (orderBy[field] && sortIcon.data(\"val\") != orderBy[field]) {\n\t\t\t\t\t\tsortIcon.trigger(\"click\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.addRow();\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Add new row\n\t\t */\n\t\taddRow: function() {\n\t\t\tlet sortContainer = this.container\n\t\t\t\t.find(\".js-base-element\")\n\t\t\t\t.clone(true, true)\n\t\t\t\t.removeClass(\"js-base-element\");\n\t\t\tthis.container.find(\".js-sort-container\").append(sortContainer);\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(sortContainer.find(\"select\"));\n\t\t\treturn sortContainer.removeClass(\"d-none\");\n\t\t},\n\t\t/**\n\t\t * Register list events\n\t\t */\n\t\tregisterListEvents: function() {\n\t\t\tthis.container.find(\".js-add\").on(\"click\", e => {\n\t\t\t\tthis.addRow();\n\t\t\t});\n\t\t\tthis.container.find(\".js-clear\").on(\"click\", e => {\n\t\t\t\t$(e.currentTarget)\n\t\t\t\t\t.closest(\".js-sort-container_element\")\n\t\t\t\t\t.remove();\n\t\t\t});\n\t\t\tthis.container.find(\".js-sort-order-button\").on(\"click\", e => {\n\t\t\t\tlet element = $(e.currentTarget).closest(\".js-sort-container_element\");\n\t\t\t\telement.find(\".js-sort-icon\").toggleClass(\"d-none js-sort-icon-active\");\n\t\t\t\telement.find(\".js-sort-order\").val(element.find(\".js-sort-icon-active\").data(\"val\"));\n\t\t\t});\n\t\t\tthis.container.find(\".js-modal__save\").on(\"click\", e => {\n\t\t\t\te.preventDefault;\n\t\t\t\tlet sortData = {};\n\t\t\t\tthis.container.find(\".js-sort-container_element:not(.js-base-element)\").each(function() {\n\t\t\t\t\tlet orderBy = $(this)\n\t\t\t\t\t\t.find(\".js-orderBy\")\n\t\t\t\t\t\t.val();\n\t\t\t\t\tif (orderBy) {\n\t\t\t\t\t\tsortData[orderBy] = $(this)\n\t\t\t\t\t\t\t.find(\".js-sort-order\")\n\t\t\t\t\t\t\t.val();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.sourceContainer.find(\".js-list-reload\").trigger(\"click\", { orderby: sortData });\n\t\t\t\tapp.hideModalWindow(null, this.source);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register modal events\n\t\t * @param {jQuery} modalContainer\n\t\t */\n\t\tregisterEvents: function(modalContainer) {\n\t\t\tthis.container = modalContainer;\n\t\t\tthis.source = modalContainer.closest(\".js-modal-container\").attr(\"id\");\n\t\t\tthis.sourceContainer = $(\"[data-modalid=\" + this.source + \"]\").closest(\n\t\t\t\t\".listViewContentDiv,.relatedContainer\"\n\t\t\t);\n\t\t\tthis.registerListEvents();\n\t\t\tthis.loadData();\n\t\t}\n\t}\n);\n"],"names":["$","Class","container","sourceContainer","source","loadData","find","val","orderBy","JSON","parse","Object","keys","length","baseOrderBy","field","addRow","element","change","sortIcon","data","trigger","clone","removeClass","append","sortContainer","App","Fields","Picklist","showSelect2ElementView","registerListEvents","on","e","currentTarget","closest","remove","toggleClass","preventDefault","each","sortData","orderby","app","hideModalWindow","registerEvents","modalContainer","attr"],"mappings":"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"}