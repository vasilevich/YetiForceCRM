{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_Edit_Js(\"OSSPasswords_Edit_Js\", {}, {\n\t/**\n\t * Function to register recordpresave event\n\t */\n\tregisterRecordPreSaveEvent: function (form) {\n\t\tvar thisInstance = this;\n\t\tif (typeof form === \"undefined\") {\n\t\t\tform = this.getForm();\n\t\t}\n\t\tform.on(Vtiger_Edit_Js.recordPreSave, function (e, data) {\n\t\t\tvar password = form.find('[name=\"password\"]').val();\n\t\t\tvar id = form.find('[name=\"record\"]').val();\n\t\t\tvar params = {};\n\t\t\tif (password === '**********') {\n\t\t\t\tparams = {};\n\t\t\t\tparams.data = {\n\t\t\t\t\tmodule: \"OSSPasswords\",\n\t\t\t\t\taction: \"GetPass\",\n\t\t\t\t\trecord: id\n\t\t\t\t};\n\t\t\t\tparams.async = false;\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tvar response = data['result'];\n\t\t\t\t\tif (response['success']) {\n\t\t\t\t\t\tvar el = document.getElementById(\"OSSPasswords_editView_fieldName_password\");\n\t\t\t\t\t\tel.value = response['password'];\n\t\t\t\t\t\tel.onchange();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t// validate password\n\t\t\t\tPasswordHelper.passwordStrength('', '');\n\t\t\t}\n\t\t\tpassword = form.find('[name=\"password\"]').val();\n\t\t\tparams = {};\n\t\t\tparams.data = {module: 'OSSPasswords', action: 'CheckPass', 'password': password, 'id': id};\n\t\t\tparams.async = false;\n\t\t\tparams.dataType = 'json';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data.result.success === false) {\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\ttext: data.result.message,\n\t\t\t\t\t\tsticker: false,\n\t\t\t\t\t\tsticker_hover: false,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t};\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t\tthisInstance.sending = false;\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t} else if (data.result.success === true && (thisInstance.sending === undefined || !thisInstance.sending)) {\n\t\t\t\t\tthisInstance.sending = true;\n\t\t\t\t} else if (thisInstance.sending) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\n\t\t\t});\n\t\t});\n\t},\n\tgeneratePassword: function (e) {\n\t\tvar element = jQuery(e.currentTarget);\n\t\tvar form = element.closest('form');\n\t\tvar min = parseInt(jQuery('#minChars').val());\n\t\tvar max = parseInt(jQuery('#maxChars').val());\n\t\tvar allowedChars = jQuery('#allowedLetters').val();\n\t\tvar password = '';   // variable holding new password\n\t\t// array of allowed characters that will consist of password\n\t\t// if there there is something wrong build the password from only exclamation marks\n\t\tif (typeof (allowedChars) === \"undefined\")\n\t\t\tallowedChars = '!';\n\t\tvar chArray = allowedChars.split(',');\n\t\t// min length of a password\n\t\tif (typeof (min) === \"undefined\")\n\t\t\tmin = 10;   // default 10\n\t\t// max length of a password\n\t\tif (typeof (max) === \"undefined\")\n\t\t\tmax = 15;   // default 15\n\t\t// get the password length\n\t\tvar passlength = parseInt(Math.random() * (max - min) + min);\n\t\tvar i = 0;    // index for the loop\n\t\t// loop to get random string with *pass_length* characters\n\t\tfor (i = 0; i <= passlength; i++) {\n\t\t\tvar charIndex = parseInt(Math.random() * chArray.length);\n\t\t\tpassword += chArray[charIndex];\n\t\t}\n\t\t// get desired text field\n\t\tvar passForm = form.find('[name =\"password\"]');\n\t\t// change its value to the generated password\n\t\tpassForm.val(password);\n\t\tpassForm.trigger('change');\n\t},\n\tregisterButtonsEvents: function () {\n\t\tvar thisInstance = this;\n\t\t$('.js-generatePass').on('click', function (e) {\n\t\t\tthisInstance.generatePassword(e);\n\t\t});\n\t},\n\tregisterBasicEvents: function (container) {\n\t\tthis._super(container);\n\t\tthis.registerButtonsEvents();\n\t\tthis.registerRecordPreSaveEvent(container);\n\t}\n});\n"],"names":["Vtiger_Edit_Js","registerRecordPreSaveEvent","form","getForm","on","recordPreSave","e","find","val","id","params","data","module","action","record","async","AppConnector","request","done","response","document","getElementById","el","value","onchange","PasswordHelper","passwordStrength","password","dataType","result","success","text","message","sticker","sticker_hover","type","Vtiger_Helper_Js","showPnotify","thisInstance","sending","preventDefault","stopPropagation","generatePassword","jQuery","currentTarget","element","closest","min","parseInt","max","allowedChars","split","Math","random","i","passlength","chArray","length","charIndex","passForm","trigger","registerButtonsEvents","$","registerBasicEvents","container","_super"],"mappings":"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"}