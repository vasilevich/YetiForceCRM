{"version":3,"file":"outlookMessageDetail.min.js","sources":["outlookMessageDetail.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n\nconst MailIntegration_Start = {\n\tiframe: {},\n\t/**\n\t * Set iframe element.\n\t */\n\tsetIframe() {\n\t\tthis.iframe = $('#js-iframe');\n\t},\n\t/**\n\t * Show detail view.\n\t *\n\t * @param   {object}  mailItem  Office mailbox.item\n\t */\n\tshowDetailView(mailItem) {\n\t\tAppConnector.request(\n\t\t\t$.extend(\n\t\t\t\t{\n\t\t\t\t\tmodule: 'MailIntegration',\n\t\t\t\t\tview: 'Iframe',\n\t\t\t\t\tmailFrom: mailItem.from.emailAddress,\n\t\t\t\t\tmailSender: mailItem.sender.emailAddress,\n\t\t\t\t\tmailSubject: mailItem.subject,\n\t\t\t\t\tmailNormalizedSubject: mailItem.normalizedSubject,\n\t\t\t\t\tmailMessageId: mailItem.internetMessageId,\n\t\t\t\t\tmailDateTimeCreated: mailItem.dateTimeCreated.toISOString()\n\t\t\t\t},\n\t\t\t\twindow.PanelParams\n\t\t\t)\n\t\t)\n\t\t\t.done(responseData => {\n\t\t\t\t$('#page').html(responseData);\n\t\t\t\tthis.registerLogoutEvents();\n\t\t\t})\n\t\t\t.fail(_ => {\n\t\t\t\tOffice.context.mailbox.item.notificationMessages.replaceAsync('error', {\n\t\t\t\t\ttype: 'errorMessage',\n\t\t\t\t\tmessage: app.vtranslate('JS_ERROR')\n\t\t\t\t});\n\t\t\t});\n\t},\n\t/**\n\t * Register logout events\n\t */\n\tregisterLogoutEvents() {\n\t\tthis.setIframe();\n\t\tlet reloadPanelAfterLogout = () => {\n\t\t\tif (!this.isUserLoggedIn()) {\n\t\t\t\twindow.location.reload();\n\t\t\t}\n\t\t};\n\t\tthis.iframe.on('load', reloadPanelAfterLogout);\n\t},\n\t/**\n\t * Register login events.\n\t */\n\tregisterLoginEvents() {\n\t\tlet loader;\n\t\tlet reloadPanelAfterLogin = () => {\n\t\t\tif (this.isUserLoggedIn()) {\n\t\t\t\twindow.location.reload();\n\t\t\t} else {\n\t\t\t\tloader.progressIndicator({ mode: 'hide' });\n\t\t\t}\n\t\t};\n\t\tlet showLoader = () => {\n\t\t\tloader = $.progressIndicator({\n\t\t\t\tblockInfo: { enabled: true },\n\t\t\t\tmessage: false,\n\t\t\t\tblockOverlayCSS: {\n\t\t\t\t\t'background-color': 'white',\n\t\t\t\t\topacity: 1\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\tthis.iframe.on('load', reloadPanelAfterLogin);\n\t\t$(this.iframe[0].contentWindow).on('unload', showLoader);\n\t},\n\t/**\n\t * Is user logged in.\n\t *\n\t * @return  {boolean}\n\t */\n\tisUserLoggedIn() {\n\t\tlet iframeCONFIG = this.iframe[0].contentWindow.CONFIG;\n\t\treturn iframeCONFIG && iframeCONFIG.userId;\n\t},\n\t/**\n\t * Register events.\n\t *\n\t * @param   {object}  mailbox  Office mailbox\n\t */\n\tregisterEvents(mailbox) {\n\t\tif (!$('.js-exception-error').length) {\n\t\t\tthis.setIframe();\n\t\t\tif (this.iframe.data('view') === 'login') {\n\t\t\t\tthis.registerLoginEvents();\n\t\t\t} else {\n\t\t\t\tthis.showDetailView(mailbox.item);\n\t\t\t}\n\t\t}\n\t}\n};\nOffice.onReady(info => {\n\twindow.PanelParams = {\n\t\tsource: 'Outlook',\n\t\tdevice: Office.context.mailbox.diagnostics.hostName\n\t};\n\tif (info.host === Office.HostType.Outlook) {\n\t\tMailIntegration_Start.registerEvents(Office.context.mailbox);\n\t}\n});\n"],"names":["iframe","setIframe","$","showDetailView","mailItem","AppConnector","request","extend","module","view","mailFrom","from","emailAddress","mailSender","sender","mailSubject","subject","mailNormalizedSubject","normalizedSubject","mailMessageId","internetMessageId","mailDateTimeCreated","dateTimeCreated","toISOString","window","PanelParams","done","html","responseData","registerLogoutEvents","fail","Office","context","mailbox","item","notificationMessages","replaceAsync","type","message","app","vtranslate","on","isUserLoggedIn","location","reload","registerLoginEvents","loader","reloadPanelAfterLogin","progressIndicator","mode","contentWindow","blockInfo","enabled","blockOverlayCSS","opacity","CONFIG","iframeCONFIG","userId","registerEvents","length","data","onReady","source","device","diagnostics","hostName","info","host","HostType","Outlook","MailIntegration_Start"],"mappings":";;AAAA,kKAEA,0BAA8B,CAC7BA,OAAQ,EADqB;;IAK7BC,SAL6B,qBAKjB,CACX,KAAKD,MAAL,CAAcE,EAAE,YAAF,EACd,CAP4B;;;;IAa7BC,cAb6B,yBAadC,QAbc,CAaJ,gBACxBC,aAAaC,OAAb,CACCJ,EAAEK,MAAF,CACC,CACCC,OAAQ,iBADT,CAECC,KAAM,QAFP,CAGCC,SAAUN,SAASO,IAAT,CAAcC,YAHzB,CAICC,WAAYT,SAASU,MAAT,CAAgBF,YAJ7B,CAKCG,YAAaX,SAASY,OALvB,CAMCC,sBAAuBb,SAASc,iBANjC,CAOCC,cAAef,SAASgB,iBAPzB,CAQCC,oBAAqBjB,SAASkB,eAAT,CAAyBC,WAAzB,EARtB,CADD,CAWCC,OAAOC,WAXR,CADD,EAeEC,IAfF,CAeO,sBAAgB,CACrBxB,EAAE,OAAF,EAAWyB,IAAX,CAAgBC,YAAhB,CADqB,CAErB,MAAKC,oBAAL,GACA,CAlBF,EAmBEC,IAnBF,CAmBO,UAAK,CACVC,OAAOC,OAAP,CAAeC,OAAf,CAAuBC,IAAvB,CAA4BC,oBAA5B,CAAiDC,YAAjD,CAA8D,OAA9D,CAAuE,CACtEC,KAAM,cADgE,CAEtEC,QAASC,IAAIC,UAAJ,CAAe,UAAf,CAF6D,CAAvE,EAIA,CAxBF,EAyBA,CAvC4B;;IA2C7BX,oBA3C6B,gCA2CN,iBACtB,KAAK5B,SAAL,EADsB,CAOtB,KAAKD,MAAL,CAAYyC,EAAZ,CAAe,MAAf,CAL6B,+BAAA,EAAM,CAC7B,OAAKC,cAAL,EAD6B,EAEjClB,OAAOmB,QAAP,CAAgBC,MAAhB,GAED,CACD,EACA,CAnD4B;;IAuD7BC,mBAvD6B,+BAuDP,iBACjBC,aADiB,CAEjBC,sBAAwB,UAAM,CAC7B,OAAKL,cAAL,EAD6B,CAEhClB,OAAOmB,QAAP,CAAgBC,MAAhB,EAFgC,CAIhCE,OAAOE,iBAAP,CAAyB,CAAEC,KAAM,MAAR,CAAzB,EAED,CARoB,CAmBrB,KAAKjD,MAAL,CAAYyC,EAAZ,CAAe,MAAf,CAAuBM,qBAAvB,CAnBqB,CAoBrB7C,EAAE,KAAKF,MAAL,CAAY,CAAZ,EAAekD,aAAjB,EAAgCT,EAAhC,CAAmC,QAAnC,CAXiB,mBAAA,EAAM,CACtBK,OAAS5C,EAAE8C,iBAAF,CAAoB,CAC5BG,UAAW,CAAEC,UAAF,CADiB,CAE5Bd,UAF4B,CAG5Be,gBAAiB,CAChB,mBAAoB,OADJ,CAEhBC,QAAS,CAFO,CAHW,CAApB,EAQT,CAED,EACA,CA5E4B;;;;IAkF7BZ,cAlF6B,0BAkFZ,CAChB,iBAAmB,KAAK1C,MAAL,CAAY,CAAZ,EAAekD,aAAf,CAA6BK,MAAhD,CACA,qBAAuBC,aAAaC,MACpC,CArF4B;;;;IA2F7BC,cA3F6B,yBA2FdzB,OA3Fc,CA2FL,CAClB/B,EAAE,qBAAF,EAAyByD,MADP,GAEtB,KAAK1D,SAAL,EAFsB,CAGW,OAA7B,QAAKD,MAAL,CAAY4D,IAAZ,CAAiB,MAAjB,CAHkB,CAIrB,KAAKf,mBAAL,EAJqB,CAMrB,KAAK1C,cAAL,CAAoB8B,QAAQC,IAA5B,CANqB,EASvB,CApG4B,CAA9B,CAsGAH,OAAO8B,OAAP,CAAe,cAAQ,CACtBrC,OAAOC,WAAP,CAAqB,CACpBqC,OAAQ,SADY,CAEpBC,OAAQhC,OAAOC,OAAP,CAAeC,OAAf,CAAuB+B,WAAvB,CAAmCC,QAFvB,CADC,CAKlBC,KAAKC,IAAL,GAAcpC,OAAOqC,QAAP,CAAgBC,OALZ,EAMrBC,sBAAsBZ,cAAtB,CAAqC3B,OAAOC,OAAP,CAAeC,OAApD,EAED,CARD"}