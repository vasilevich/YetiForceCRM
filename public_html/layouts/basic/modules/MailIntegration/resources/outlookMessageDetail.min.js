'use strict';

/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */var MailIntegration_Start={iframe:{},/**
	 * Set iframe element.
	 */setIframe:function setIframe(){this.iframe=$('#js-iframe');},/**
	 * Show detail view.
	 *
	 * @param   {object}  mailItem  Office mailbox.item
	 */showDetailView:function showDetailView(mailItem){var _this=this;AppConnector.request($.extend({module:'MailIntegration',view:'Iframe',mailFrom:mailItem.from.emailAddress,mailSender:mailItem.sender.emailAddress,mailSubject:mailItem.subject,mailNormalizedSubject:mailItem.normalizedSubject,mailMessageId:mailItem.internetMessageId,mailDateTimeCreated:mailItem.dateTimeCreated.toISOString()},window.PanelParams)).done(function(responseData){$('#page').html(responseData),_this.registerLogoutEvents();}).fail(function(){Office.context.mailbox.item.notificationMessages.replaceAsync('error',{type:'errorMessage',message:app.vtranslate('JS_ERROR')});});},/**
	 * Register logout events
	 */registerLogoutEvents:function registerLogoutEvents(){var _this2=this;this.setIframe();this.iframe.on('load',function reloadPanelAfterLogout(){_this2.isUserLoggedIn()||window.location.reload();});},/**
	 * Register login events.
	 */registerLoginEvents:function registerLoginEvents(){var _this3=this,loader=void 0,reloadPanelAfterLogin=function(){_this3.isUserLoggedIn()?window.location.reload():loader.progressIndicator({mode:'hide'});};this.iframe.on('load',reloadPanelAfterLogin),$(this.iframe[0].contentWindow).on('unload',function showLoader(){loader=$.progressIndicator({blockInfo:{enabled:!0},message:!1,blockOverlayCSS:{"background-color":'white',opacity:1}});});},/**
	 * Is user logged in.
	 *
	 * @return  {boolean}
	 */isUserLoggedIn:function isUserLoggedIn(){var iframeCONFIG=this.iframe[0].contentWindow.CONFIG;return iframeCONFIG&&iframeCONFIG.userId},/**
	 * Register events.
	 *
	 * @param   {object}  mailbox  Office mailbox
	 */registerEvents:function registerEvents(mailbox){$('.js-exception-error').length||(this.setIframe(),'login'===this.iframe.data('view')?this.registerLoginEvents():this.showDetailView(mailbox.item));}};Office.onReady(function(info){window.PanelParams={source:'Outlook',device:Office.context.mailbox.diagnostics.hostName},info.host===Office.HostType.Outlook&&MailIntegration_Start.registerEvents(Office.context.mailbox);});
//# sourceMappingURL=outlookMessageDetail.min.js.map
