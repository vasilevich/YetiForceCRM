{"version":3,"file":"TwoFactorAuthenticationModal.min.js","sources":["TwoFactorAuthenticationModal.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\"Base_TwoFactorAuthenticationModal_JS\", {}, {\n\t/**\n\t * Function to handle sending the AJAX form\n\t * @param data\n\t */\n\tregisterSubmitFrom(data) {\n\t\tdata.find('button[name=saveButton]').prop(\"disabled\", true);\n\t\tdata.find('input[name=user_code]').on('keyup', (e) => {\n\t\t\tif (e.keyCode !== 13) {\n\t\t\t\tdata.find('button[name=saveButton]').prop(\"disabled\", $(e.currentTarget).val().length === 0);\n\t\t\t}\n\t\t});\n\t\tdata.find('input[name=user_code]').on('change', (e) => {\n\t\t\tdata.find('button[name=saveButton]').prop(\"disabled\", $(e.currentTarget).val().length === 0);\n\t\t});\n\t\tdata.find('input[name=turn_off_2fa]').on('change', (e) => {\n\t\t\tif ($(e.currentTarget).prop(\"checked\")) {\n\t\t\t\tdata.find('.js-qr-code,.js-user-code').addClass('hide');\n\t\t\t\tdata.find('input[name=mode]').val('off');\n\t\t\t\tdata.find('button[name=saveButton]').prop(\"disabled\", false);\n\t\t\t} else {\n\t\t\t\tdata.find('.js-qr-code,.js-user-code').removeClass('hide');\n\t\t\t\tdata.find('input[name=mode]').val('secret');\n\t\t\t\tdata.find('button[name=saveButton]').prop(\"disabled\", true);\n\t\t\t\tdata.find('input[name=user_code]').val('');\n\t\t\t}\n\t\t});\n\t\tlet form = data.find('form');\n\t\tform.on('submit', (e) => {\n\t\t\tlet progress = $.progressIndicator({blockInfo: {'enabled': true}});\n\t\t\tAppConnector.request(form.serializeFormData()).done((respons) => {\n\t\t\t\tif (respons.result.success) {\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\ttext: app.vtranslate(respons.result.message),\n\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\tanimation: 'show'\n\t\t\t\t\t});\n\t\t\t\t\tif (app.getModuleName() === 'Users') {\n\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tlet wrongCode = form.find('.js-wrong-code');\n\t\t\t\t\tif (wrongCode.hasClass('hide')) {\n\t\t\t\t\t\twrongCode.removeClass('hide');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tprogress.progressIndicator({mode: 'hide'});\n\t\t\t});\n\t\t\te.preventDefault();\n\t\t});\n\t},\n\t/**\n\t * Register base events\n\t * @param {jQuery} modalContainer\n\t */\n\tregisterEvents(modalContainer) {\n\t\tthis.registerSubmitFrom(modalContainer);\n\t}\n});\n"],"names":["$","Class","registerSubmitFrom","data","find","prop","on","e","keyCode","currentTarget","val","length","addClass","removeClass","form","progressIndicator","blockInfo","AppConnector","request","serializeFormData","done","respons","result","success","app","hideModalWindow","Vtiger_Helper_Js","showPnotify","text","vtranslate","message","type","animation","getModuleName","location","reload","wrongCode","hasClass","progress","mode","preventDefault","registerEvents","modalContainer"],"mappings":";;AAGAA,EAAEC,KAAF,CAAQ,sCAAR,CAAgD,EAAhD,CAAoD;;;IAKnDC,kBALmD,6BAKhCC,IALgC,CAK1B,CACxBA,KAAKC,IAAL,CAAU,yBAAV,EAAqCC,IAArC,CAA0C,UAA1C,IADwB,CAExBF,KAAKC,IAAL,CAAU,uBAAV,EAAmCE,EAAnC,CAAsC,OAAtC,CAA+C,SAACC,CAAD,CAAO,CACnC,EAAd,KAAEC,OAD+C,EAEpDL,KAAKC,IAAL,CAAU,yBAAV,EAAqCC,IAArC,CAA0C,UAA1C,CAA0F,CAApC,KAAEE,EAAEE,aAAJ,EAAmBC,GAAnB,GAAyBC,MAA/E,EAED,CAJD,CAFwB,CAOxBR,KAAKC,IAAL,CAAU,uBAAV,EAAmCE,EAAnC,CAAsC,QAAtC,CAAgD,SAACC,CAAD,CAAO,CACtDJ,KAAKC,IAAL,CAAU,yBAAV,EAAqCC,IAArC,CAA0C,UAA1C,CAA0F,CAApC,KAAEE,EAAEE,aAAJ,EAAmBC,GAAnB,GAAyBC,MAA/E,EACA,CAFD,CAPwB,CAUxBR,KAAKC,IAAL,CAAU,0BAAV,EAAsCE,EAAtC,CAAyC,QAAzC,CAAmD,SAACC,CAAD,CAAO,CACrDP,EAAEO,EAAEE,aAAJ,EAAmBJ,IAAnB,CAAwB,SAAxB,CADqD,EAExDF,KAAKC,IAAL,CAAU,2BAAV,EAAuCQ,QAAvC,CAAgD,MAAhD,CAFwD,CAGxDT,KAAKC,IAAL,CAAU,kBAAV,EAA8BM,GAA9B,CAAkC,KAAlC,CAHwD,CAIxDP,KAAKC,IAAL,CAAU,yBAAV,EAAqCC,IAArC,CAA0C,UAA1C,IAJwD,GAMxDF,KAAKC,IAAL,CAAU,2BAAV,EAAuCS,WAAvC,CAAmD,MAAnD,CANwD,CAOxDV,KAAKC,IAAL,CAAU,kBAAV,EAA8BM,GAA9B,CAAkC,QAAlC,CAPwD,CAQxDP,KAAKC,IAAL,CAAU,yBAAV,EAAqCC,IAArC,CAA0C,UAA1C,IARwD,CASxDF,KAAKC,IAAL,CAAU,uBAAV,EAAmCM,GAAnC,CAAuC,EAAvC,CATwD,EAWzD,CAXD,CAVwB,CAsBxB,SAAWP,KAAKC,IAAL,CAAU,MAAV,CAAX,CACAU,KAAKR,EAAL,CAAQ,QAAR,CAAkB,SAACC,CAAD,CAAO,CACxB,aAAeP,EAAEe,iBAAF,CAAoB,CAACC,UAAW,CAAC,UAAD,CAAZ,CAApB,CAAf,CACAC,aAAaC,OAAb,CAAqBJ,KAAKK,iBAAL,EAArB,EAA+CC,IAA/C,CAAoD,SAACC,OAAD,CAAa,CAChE,GAAIA,QAAQC,MAAR,CAAeC,OAAnB,CACCC,IAAIC,eAAJ,EADD,CAECC,iBAAiBC,WAAjB,CAA6B,CAC5BC,KAAMJ,IAAIK,UAAJ,CAAeR,QAAQC,MAAR,CAAeQ,OAA9B,CADsB,CAE5BC,KAAM,SAFsB,CAG5BC,UAAW,MAHiB,CAA7B,CAFD,CAO6B,OAAxB,OAAIC,aAAJ,EAPL,EAQEC,SAASC,MAAT,EARF,KAUO,CACN,cAAgBrB,KAAKV,IAAL,CAAU,gBAAV,CAAhB,CACIgC,UAAUC,QAAV,CAAmB,MAAnB,CAFE,EAGLD,UAAUvB,WAAV,CAAsB,MAAtB,EAED,CACDyB,SAASvB,iBAAT,CAA2B,CAACwB,KAAM,MAAP,CAA3B,EACA,CAlBD,CAFwB,CAqBxBhC,EAAEiC,cAAF,GACA,CAtBD,EAuBA,CAnDkD;;;IAwDnDC,cAxDmD,yBAwDpCC,cAxDoC,CAwDpB,CAC9B,KAAKxC,kBAAL,CAAwBwC,cAAxB,EACA,CA1DkD,CAApD"}