'use strict';

jQuery.Class('Settings_AutomaticAssignment_Edit_Js',{},{container:!1,advanceFilterInstance:!1,getContainer:function getContainer(){return !1==this.container&&(this.container=jQuery('div.contentsDiv')),this.container},registerBasicEvents:function registerBasicEvents(container){var thisInstance=this,advanceFilterContainer=container.find('.filterContainer');advanceFilterContainer.length&&(this.advanceFilterInstance=Vtiger_AdvanceFilter_Js.getInstance(advanceFilterContainer));var form=container.find('form');form.length&&(form.validationEngine(app.validationEngineOptions),form.find('[data-inputmask]').inputmask()),container.find('.select2noactive').each(function(index,domElement){var select=$(domElement);select.data('select2')||App.Fields.Picklist.showSelect2ElementView(select,{placeholder:app.vtranslate('JS_SELECT_AN_OPTION')});});var table=app.registerDataTables(container.find('.dataTable'));table&&(table.$('.changeRoleType').on('click',function(e){e.stopPropagation(),e.preventDefault();var element=jQuery(e.currentTarget),dataElement=element.closest('tr');app.saveAjax('changeRoleType',dataElement.data('value'),{record:app.getMainParams('record')}).done(function(){thisInstance.refreshTab();});}),table.$('.delete').on('click',function(e){e.stopPropagation(),e.preventDefault();var element=jQuery(e.currentTarget),dataElement=element.closest('tr'),params={record:app.getMainParams('record'),value:dataElement.data('value'),name:dataElement.data('name')};app.saveAjax('deleteElement',null,params).done(function(){thisInstance.refreshTab();});})),container.find('.fieldContainer').on('click',function(e){e.stopPropagation(),e.preventDefault();}),container.find('.saveValue').on('click',function(e){var button=jQuery(e.currentTarget),fieldContainer=button.closest('.fieldContainer'),baseFieldName=fieldContainer.data('dbname'),value='';if('conditions'===baseFieldName){var advfilterlist=thisInstance.advanceFilterInstance.getValues();value=JSON.stringify(advfilterlist);}else {var fieldName=fieldContainer.data('name'),fieldElement=fieldContainer.find('[name="'+fieldName+'"]');if(fieldElement.validationEngine('validate'))return !1;value=fieldElement.val();}var params=[];params[baseFieldName]=value,app.saveAjax('save',jQuery.extend({},params),{record:app.getMainParams('record')}).done(function(){thisInstance.refreshTab();});}),container.find('.js-switch').on('change',function(e){var currentTarget=$(e.currentTarget),state=currentTarget.val(),params=[];if(currentTarget.hasClass('noField')){if('1'===state)return currentTarget.closest('form').find('.fieldToShowHide').removeClass('d-none'),!1;'0'===state&&currentTarget.closest('form').find('.fieldToShowHide').addClass('d-none');}params[currentTarget.attr('name')]=Number(state),app.saveAjax('save',jQuery.extend({},params),{record:app.getMainParams('record')}).done(function(){thisInstance.refreshTab();});});},refreshTab:function refreshTab(){var thisInstance=this;Settings_Vtiger_Index_Js.showMessage({text:app.vtranslate('JS_SAVE_SUCCESS')});var tabContainer=this.getContainer().find('.tab-pane.active');return !tabContainer.hasClass('noRefresh')&&void AppConnector.request(tabContainer.data('url')).done(function(data){tabContainer.html(data),thisInstance.registerBasicEvents(tabContainer);}).fail(function(textStatus,errorThrown){app.errorLog(textStatus,errorThrown);})},registerEvents:function registerEvents(){this.registerBasicEvents(this.getContainer());}});
//# sourceMappingURL=Edit.min.js.map
