{"version":3,"file":"WebserviceApps.min.js","sources":["WebserviceApps.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class('Settings_WebserviceApps_Index_Js', {}, {\n\t/**\n\t * Get container\n\t *\n\t * @returns {HTMLElement|jQuery}\n\t */\n\tgetContainer() {\n\t\treturn this.container;\n\t},\n\t/**\n\t * Register actions for record\n\t */\n\tregisterTableEvents: function () {\n\t\tvar thisInstance = this;\n\t\tconst container = this.container = $('.configContainer');\n\t\tcontainer.find('.edit').on('click', function (e) {\n\t\t\tvar currentTarget = $(e.currentTarget);\n\t\t\tvar trRow = currentTarget.closest('tr');\n\t\t\tthisInstance.showFormToEditKey(trRow.data('id'));\n\t\t});\n\t\tcontainer.find('.remove').on('click', function (e) {\n\t\t\tvar removeButton = jQuery(e.currentTarget);\n\t\t\tvar currentTrElement = removeButton.closest('tr');\n\t\t\tvar message = app.vtranslate('JS_DELETE_CONFIRMATION');\n\t\t\tVtiger_Helper_Js.showConfirmationBox({ 'message': message }).done(function (e) {\n\t\t\t\tvar params = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\taction: 'Delete',\n\t\t\t\t\tid: currentTrElement.data('id')\n\t\t\t\t};\n\t\t\t\tvar progress = jQuery.progressIndicator();\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tprogress.progressIndicator({ 'mode': 'hide' });\n\t\t\t\t\tthisInstance.loadTable();\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Refresh tables with records\n\t */\n\tloadTable: function () {\n\t\tvar thisInstance = this;\n\t\tvar params = {\n\t\t\tmodule: app.getModuleName(),\n\t\t\tparent: app.getParentModuleName(),\n\t\t\tview: 'Index',\n\t\t};\n\t\tvar progress = jQuery.progressIndicator();\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\tprogress.progressIndicator({ 'mode': 'hide' });\n\t\t\t$('.configContainer').html(data);\n\t\t\tthisInstance.registerTableEvents();\n\t\t});\n\t},\n\t/**\n\t * Show forms to edit or create record\n\t * @param {int} id\n\t */\n\tshowFormToEditKey: function (id) {\n\t\tvar thisInstance = this;\n\t\tvar params = {\n\t\t\tmodule: app.getModuleName(),\n\t\t\tparent: app.getParentModuleName(),\n\t\t\tview: 'CreateApp',\n\t\t};\n\t\tif (id != '') {\n\t\t\tparams['record'] = id;\n\t\t}\n\t\tvar progress = jQuery.progressIndicator();\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\tprogress.progressIndicator({ 'mode': 'hide' });\n\t\t\tapp.showModalWindow(data, function (container) {\n\t\t\t\tconst prevButton = container.find('.previewPassword');\n\t\t\t\tconst password = container.find('[name=\"pass\"]');\n\t\t\t\tprevButton.on('mousedown', function (e) {\n\t\t\t\t\tpassword.attr('type', 'text');\n\t\t\t\t});\n\t\t\t\tprevButton.on('mouseup', function (e) {\n\t\t\t\t\tpassword.attr('type', 'password');\n\t\t\t\t});\n\t\t\t\tprevButton.on('mouseout', function (e) {\n\t\t\t\t\tpassword.attr('type', 'password');\n\t\t\t\t});\n\t\t\t\tconst clipboard = App.Fields.Text.registerCopyClipboard(container, '.copyPassword');\n\t\t\t\tcontainer.one('hidden.bs.modal', function () {\n\t\t\t\t\tclipboard.destroy();\n\t\t\t\t});\n\t\t\t\tvar form = container.find('form');\n\t\t\t\tform.validationEngine(app.validationEngineOptions);\n\t\t\t\tcontainer.find('[name=\"saveButton\"]').on('click', function () {\n\t\t\t\t\tif (form.validationEngine('validate')) {\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\t\t\t\taction: 'SaveAjax',\n\t\t\t\t\t\t\tname: container.find('[name=\"name\"]').val(),\n\t\t\t\t\t\t\turl: container.find('[name=\"addressUrl\"]').val(),\n\t\t\t\t\t\t\tstatus: container.find('[name=\"status\"]').is(':checked'),\n\t\t\t\t\t\t\ttype: container.find('.typeServer').val(),\n\t\t\t\t\t\t\tpass: password.val(),\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif (id != '') {\n\t\t\t\t\t\t\tparams['id'] = id;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\t\t\tif (data.result === true) {\n\t\t\t\t\t\t\t\tthisInstance.loadTable();\n\t\t\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\t\t} else if (typeof data.result.error !== 'undefined') {\n\t\t\t\t\t\t\t\tVtiger_Helper_Js.showPnotify(data.result.error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Register button to create record\n\t */\n\tregisterAddButton: function () {\n\t\tvar thisInstance = this\n\t\t$('.createKey').on('click', function () {\n\t\t\tthisInstance.showFormToEditKey();\n\t\t});\n\t},\n\t/**\n\t * Main function\n\t */\n\tregisterEvents: function () {\n\t\tthis.registerAddButton();\n\t\tthis.registerTableEvents();\n\t\tApp.Fields.Text.registerCopyClipboard(this.getContainer());\n\t}\n})\n"],"names":["$","Class","getContainer","container","registerTableEvents","find","on","e","currentTarget","trRow","closest","thisInstance","showFormToEditKey","data","jQuery","currentTrElement","removeButton","message","app","vtranslate","Vtiger_Helper_Js","showConfirmationBox","done","module","getModuleName","parent","getParentModuleName","action","id","progress","progressIndicator","AppConnector","request","params","loadTable","view","html","showModalWindow","password","prevButton","attr","App","Fields","Text","registerCopyClipboard","one","clipboard","destroy","form","validationEngine","validationEngineOptions","name","val","url","status","is","type","pass","result","hideModalWindow","error","showPnotify","registerAddButton","registerEvents"],"mappings":"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"}