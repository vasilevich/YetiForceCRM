{"version":3,"file":"List.min.js","sources":["List.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nVtiger_List_Js(\n\t'Settings_Vtiger_List_Js',\n\t{\n\t\ttriggerDelete: function(event, url) {\n\t\t\tevent.stopPropagation();\n\t\t\tvar instance = Vtiger_List_Js.getInstance();\n\t\t\tinstance.DeleteRecord(url);\n\t\t},\n\t\t/**\n\t\t * Make delete request\n\t\t *\n\t\t * @param   {object}  params\n\t\t * @param   {jQuery.Deferred}  aDeferred\n\t\t * @param   {Vtiger_List_Js}  instance\n\t\t */\n\t\tmakeDeleteRequest(params, aDeferred, instance) {\n\t\t\tAppConnector.request(params).done(data => {\n\t\t\t\tlet response = data.result;\n\t\t\t\tif (response && response.success) {\n\t\t\t\t\t$('#recordsCount').val('');\n\t\t\t\t\t$('#totalPageCount').text('');\n\t\t\t\t\tinstance.getListViewRecords().done(() => {\n\t\t\t\t\t\tinstance.updatePagination();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tVtiger_Helper_Js.showPnotify({\n\t\t\t\t\t\ttext: response.message\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\taDeferred.resolve(data);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Delete by id\n\t\t *\n\t\t * @param   {number}  id\n\t\t * @param   {bool}  showConfirmation\n\t\t *\n\t\t * @return  {jQuery.Deferred}\n\t\t */\n\t\tdeleteById(id, showConfirmation = true) {\n\t\t\tconst aDeferred = jQuery.Deferred();\n\t\t\tconst instance = Vtiger_List_Js.getInstance();\n\t\t\tconst params = $.extend(instance.getDeleteParams(), {\n\t\t\t\trecord: id\n\t\t\t});\n\t\t\tif (showConfirmation) {\n\t\t\t\tVtiger_Helper_Js.showConfirmationBox({\n\t\t\t\t\tmessage: app.vtranslate('JS_DELETE_RECORD_CONFIRMATION')\n\t\t\t\t}).done(e => {\n\t\t\t\t\tthis.makeDeleteRequest(params, aDeferred, instance);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.makeDeleteRequest(params, aDeferred, instance);\n\t\t\t}\n\t\t\treturn aDeferred.promise();\n\t\t}\n\t},\n\t{\n\t\tgetDeleteParams: function() {\n\t\t\treturn {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\taction: 'DeleteAjax'\n\t\t\t};\n\t\t},\n\t\t/*\n\t\t * Function to register the list view container\n\t\t */\n\t\tgetListViewContainer() {\n\t\t\tif (this.listViewContainer == false) {\n\t\t\t\tthis.listViewContainer = $('div.listViewPageDiv');\n\t\t\t}\n\t\t\treturn this.listViewContainer;\n\t\t},\n\n\t\t/*\n\t\t * Function to register the list view delete record click event\n\t\t */\n\t\tDeleteRecord: function(url) {\n\t\t\tvar thisInstance = this;\n\n\t\t\tAppConnector.request(url).done(function(data) {\n\t\t\t\tif (data) {\n\t\t\t\t\tapp.showModalWindow(data, function(container) {\n\t\t\t\t\t\tthisInstance.postDeleteAction(container);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Function to load list view after deletion of record from list view\n\t\t */\n\t\tpostDeleteAction: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar deleteConfirmForm = jQuery(container).find('#DeleteModal');\n\t\t\tdeleteConfirmForm.on('submit', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tvar deleteActionUrl = deleteConfirmForm.serializeFormData();\n\t\t\t\tAppConnector.request(deleteActionUrl)\n\t\t\t\t\t.done(function() {\n\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\tvar params = {\n\t\t\t\t\t\t\ttext: app.vtranslate('JS_RECORD_DELETED_SUCCESSFULLY')\n\t\t\t\t\t\t};\n\t\t\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\t\t\tjQuery('#recordsCount').val('');\n\t\t\t\t\t\tjQuery('#totalPageCount').text('');\n\t\t\t\t\t\tthisInstance.getListViewRecords().done(function() {\n\t\t\t\t\t\t\tthisInstance.updatePagination();\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Function to get Page Jump Params\n\t\t */\n\t\tgetPageJumpParams: function() {\n\t\t\tvar module = app.getModuleName();\n\t\t\tvar cvId = this.getCurrentCvId();\n\t\t\tvar pageCountParams = {\n\t\t\t\tmodule: module,\n\t\t\t\tparent: 'Settings',\n\t\t\t\taction: 'ListAjax',\n\t\t\t\tmode: 'getPageCount',\n\t\t\t\tviewname: cvId\n\t\t\t};\n\t\t\tvar sourceModule = jQuery('#moduleFilter').val();\n\t\t\tif (typeof sourceModule !== 'undefined') {\n\t\t\t\tpageCountParams['sourceModule'] = sourceModule;\n\t\t\t}\n\t\t\treturn pageCountParams;\n\t\t},\n\t\tregisterEvents: function() {\n\t\t\t//this.triggerDisplayTypeEvent();\n\t\t\tthis.registerRowClickEvent();\n\t\t\tthis.registerCheckBoxClickEvent();\n\t\t\tthis.registerHeadersClickEvent();\n\t\t\tthis.registerPageNavigationEvents();\n\t\t\tthis.registerEventForTotalRecordsCount();\n\t\t}\n\t}\n);\n"],"names":["Vtiger_List_Js","triggerDelete","event","url","stopPropagation","getInstance","instance","DeleteRecord","makeDeleteRequest","params","aDeferred","AppConnector","request","done","data","result","response","success","$","val","text","getListViewRecords","updatePagination","Vtiger_Helper_Js","showPnotify","message","resolve","deleteById","id","showConfirmation","jQuery","Deferred","extend","getDeleteParams","record","showConfirmationBox","app","vtranslate","promise","module","getModuleName","parent","getParentModuleName","action","getListViewContainer","listViewContainer","showModalWindow","container","thisInstance","postDeleteAction","deleteConfirmForm","find","on","e","preventDefault","serializeFormData","deleteActionUrl","hideModalWindow","Settings_Vtiger_Index_Js","showMessage","fail","getPageJumpParams","cvId","getCurrentCvId","pageCountParams","mode","viewname","sourceModule","registerEvents","registerRowClickEvent","registerCheckBoxClickEvent","registerHeadersClickEvent","registerPageNavigationEvents","registerEventForTotalRecordsCount"],"mappings":"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"}